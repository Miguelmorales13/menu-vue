(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{3006:function(e,t,o){"use strict";o.r(t);var s=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{attrs:{id:"Roles"}},[o("Delete",{attrs:{headers:e.headers,item:e.rolesStore.selectedRol},on:{onConfirm:e.onConfirmDelete},model:{value:e.dialogDelete,callback:function(t){e.dialogDelete=t},expression:"dialogDelete"}}),o("Table",{attrs:{headers:e.headers,loading:e.rolesStore.loader,data:e.rolesStore.roles,title:"titles.roles",hasAccessToWrite:"2"==e.authStore.accessRoles},scopedSlots:e._u([{key:"normal",fn:function(t){var s=t.item;return[o("q-btn",{attrs:{icon:"edit",size:"sm",dense:"",color:"warning"},on:{click:function(t){return e.onUpdate(s)}}}),e._v("Â \n\t\t\t\t\t"),o("q-btn",{attrs:{icon:"delete",size:"sm",dense:"",color:"red"},on:{click:function(t){return e.onDelete(s)}}})]}},{key:"card",fn:function(t){var s=t.item;return[o("q-btn",{staticClass:"q-my-xs",attrs:{size:"sm",dense:"",color:"warning"},on:{click:function(t){return e.onUpdate(s)}}},[o("q-icon",{attrs:{name:"edit"}}),e._v("\n\t\t\t\t\t\t\t\t\t\t\t\t"+e._s(e.$t("tables.edit"))+"\n\t\t\t\t\t\t\t\t\t\t\t")],1),o("q-btn",{staticClass:"q-my-xs",attrs:{size:"sm",dense:"",color:"red"},on:{click:function(t){return e.onDelete(s)}}},[o("q-icon",{attrs:{name:"delete"}}),e._v("\n\t\t\t\t\t\t\t\t\t\t\t\t"+e._s(e.$t("tables.delete"))+"\n\t\t\t\t\t\t\t\t\t\t\t")],1)]}}])},[o("FormRoles",{model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}})],1)],1)},n=[],r=o("60a3"),l=o("0748"),i=o("139f"),c=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("Modal",{attrs:{btnTitle:"",title:e.rol.id?"titles.updated":"titles.creation",loader:e.rolesStore.loader,hasBtn:"2"==e.authStore.accessRoles,btnProps:{dense:!0,fab:!0,color:"primary",icon:"add"}},on:{onConfirm:e.onSubmit,onCancel:e.onCancel},model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[o("FormFlex",{attrs:{fields:e.fields,loader:e.rolesStore.loader,model:e.rol},on:{onValidation:function(t){e.formValid=t},onSubmit:e.onSubmit}})],1)},a=[],d=o("0365"),u=o("714b"),m=o("6fc5"),f=o("68d2"),h=o("02f2"),p=o("f7c0"),b=o("f8de"),g=function(e,t,o,s){var n,r=arguments.length,l=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,o):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)l=Reflect.decorate(e,t,o,s);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(l=(r<3?n(l):r>3?n(t,o,l):n(t,o))||l);return r>3&&l&&Object.defineProperty(t,o,l),l},v=function(e,t,o,s){function n(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,r){function l(e){try{c(s.next(e))}catch(t){r(t)}}function i(e){try{c(s["throw"](e))}catch(t){r(t)}}function c(e){e.done?o(e.value):n(e.value).then(l,i)}c((s=s.apply(e,t||[])).next())}))};let S=class extends r["d"]{constructor(){super(...arguments),this.globalStore=Object(m["e"])(p["a"],this.$store),this.dialog=!1,this.formValid=!1,this.rolesStore=Object(m["e"])(f["a"],this.$store),this.authStore=Object(m["e"])(b["a"],this.$store),this.rol={access:[]},this.fields=[{type:"text",label:"forms.roles.name",key:"name",field:{class:"col-12 col-md-6 q-px-sm q-py-sm"},props:{},rules:[...h["a"].reqAndTree]},{type:"toggle",label:"forms.roles.active",key:"active",field:{class:"col-12 col-md-6 q-px-sm q-py-sm column wrap justify-center content-end"},props:{},rules:[...h["a"].reqAndTree]},{type:"accesses",label:"forms.roles.name",key:"access",field:{class:"col-12"},props:{},rules:[...h["a"].reqAndTree]}]}onCancel(){return v(this,void 0,void 0,(function*(){return this.dialog=!1,!1}))}onChange(e,t){this.dialog=e}mounted(){return v(this,void 0,void 0,(function*(){this.dialog=this.value,this.rol=Object.assign({},this.rolesStore.selectedRol)}))}onSelectedRol(e,t){this.rol=Object.assign({},e),this.resetForm()}onSubmit(){return v(this,void 0,void 0,(function*(){if(this.formValid)if(this.rol.id){yield this.rolesStore.update(Object.assign(Object.assign({},this.rol),{access:this.formatAccessToSend(this.rol.access)}));this.onCancel()}else{yield this.rolesStore.create(Object.assign(Object.assign({},this.rol),{access:this.formatAccessToSend(this.rol.access)}));this.onCancel()}}))}formatAccessToSend(e){return e.reduce(((e,t)=>[...e,...t.accesses.reduce(((e,t)=>t.isDone?[...e,{accessId:t.accessId,permission:t.permission?"2":"1"}]:e),[])]),[])}formatAccessToForm(e){return e.reduce(((e,t)=>[...e,...t.accesses.reduce(((e,t)=>t.isDone?[...e,{accessId:t.accessId,permission:t.permission?"2":"1"}]:e),[])]),[])}created(){return v(this,void 0,void 0,(function*(){yield this.globalStore.getModules("users"),this.resetForm()}))}resetForm(){this.rol=Object.assign(Object.assign({},this.rolesStore.selectedRol),{access:this.globalStore.accesses.map((e=>{var t;let o=this.rolesStore.selectedRol.access.filter((t=>t.moduleId==e.id));return{moduleId:e.id,name:e.name,isDone:o.length>0,accesses:null===(t=e.access)||void 0===t?void 0:t.map((e=>{if(o&&o.length<=0)return{isDone:!1,accessId:e.id,name:e.name,permission:!1};let t=o.find((t=>t.accessId==e.id));return t?{isDone:!0,accessId:e.id,name:e.name,permission:"2"==t.permission}:{isDone:!1,accessId:e.id,name:e.name,permission:!1}}))}}))})}};g([Object(r["c"])({type:Boolean,required:!0})],S.prototype,"value",void 0),g([Object(r["b"])("input")],S.prototype,"onCancel",null),g([Object(r["e"])("value")],S.prototype,"onChange",null),g([Object(r["e"])("rolesStore.selectedRol")],S.prototype,"onSelectedRol",null),S=g([Object(r["a"])({components:{FormFlex:d["a"],Modal:u["a"]}})],S);var y=S,j=y,O=o("2877"),D=Object(O["a"])(j,c,a,!1,null,null,null),x=D.exports,q=function(e,t,o,s){var n,r=arguments.length,l=r<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,o):s;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)l=Reflect.decorate(e,t,o,s);else for(var i=e.length-1;i>=0;i--)(n=e[i])&&(l=(r<3?n(l):r>3?n(t,o,l):n(t,o))||l);return r>3&&l&&Object.defineProperty(t,o,l),l},R=function(e,t,o,s){function n(e){return e instanceof o?e:new o((function(t){t(e)}))}return new(o||(o=Promise))((function(o,r){function l(e){try{c(s.next(e))}catch(t){r(t)}}function i(e){try{c(s["throw"](e))}catch(t){r(t)}}function c(e){e.done?o(e.value):n(e.value).then(l,i)}c((s=s.apply(e,t||[])).next())}))};let w=class extends r["d"]{constructor(){super(...arguments),this.rolesStore=Object(m["e"])(f["a"],this.$store),this.authStore=Object(m["e"])(b["a"],this.$store),this.dialog=!1,this.dialogDelete=!1,this.model={access:[]},this.headers=[{name:"id",label:"headers.roles.no",sortable:!0,required:!0,align:"center",field:"id"},{name:"name",label:"headers.roles.name",sortable:!0,required:!0,align:"center",field:"name"},{name:"options",label:"headers.roles.options",sortable:!1,required:!1,align:"center",field:"options"}]}onUpdate(e){this.rolesStore.context.commit("SET",e),this.dialog=!0}onDelete(e){this.dialogDelete=!0,this.rolesStore.context.commit("SET",e)}onDialogDelete(e,t){e||this.rolesStore.context.commit("SET")}onDialog(e,t){e||this.rolesStore.context.commit("SET")}onConfirmDelete(){return R(this,void 0,void 0,(function*(){yield this.rolesStore.delete(this.rolesStore.selectedRol),this.dialogDelete=!1}))}created(){return R(this,void 0,void 0,(function*(){yield this.rolesStore.getAll()}))}};q([Object(r["e"])("dialogDelete")],w.prototype,"onDialogDelete",null),q([Object(r["e"])("dialog")],w.prototype,"onDialog",null),w=q([Object(r["a"])({components:{Table:l["a"],FormRoles:x,Delete:i["a"]}})],w);var T=w,k=T,C=o("9c40"),I=o("0016"),F=o("eebe"),_=o.n(F),A=Object(O["a"])(k,s,n,!1,null,null,null);t["default"]=A.exports;_()(A,"components",{QBtn:C["a"],QIcon:I["a"]})}}]);